<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <script src="https://www.glowscript.org/lib/jquery/2.1/jquery.min.js"></script>
  <script src="https://www.glowscript.org/lib/jquery/2.1/jquery-ui.custom.min.js"></script>
  <script src="https://www.glowscript.org/package/glow.3.2.min.js"></script>
  <script src="https://www.glowscript.org/package/RSrun.3.2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    html, body { margin:0; padding:0; height:100%; width:100%; background:#1f2937; color:#f3f4f6; font-family:'Inter',sans-serif; }
    body { display:flex; height:100vh; overflow:hidden; }
    #leftPane { width:22rem; padding:1.2rem; background:#111827; overflow-y:auto; display:flex; flex-direction:column; gap:1rem; }
    .control-group { background:#1f2937; padding:0.8rem; border-radius:0.5rem; box-shadow:0 0 6px rgba(0,0,0,0.3); }
    .control-group label { display:flex; justify-content:space-between; align-items:center; margin-bottom:0.3rem; font-weight:600; }
    .control-inputs { display:flex; gap:0.5rem; align-items:center; }
    input[type=range] { flex:1; }
    input[type=number] { width:4rem; color:black; padding:0.2rem; border-radius:0.3rem; }
    .button-group { display:flex; gap:0.5rem; flex-wrap:wrap; }
    .button-group button { flex:1; background:#6366f1; color:white; padding:0.4rem; border:none; border-radius:0.3rem; font-weight:600; }
    .button-group button:hover { background:#4f46e5; }

    .counters-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.6rem;
      margin-top: 0.5rem;
    }
    .counter {
      background: linear-gradient(135deg, #1f2937, #374151);
      padding: 0.6rem 0.8rem;
      border-radius: 0.5rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 1rem;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .counter span:last-child {
      font-weight: bold;
      color: #facc15;
      font-size: 1.2rem;
    }
    .counter:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6);
    }

    #rightPane { flex:1; display:flex; flex-direction:row; height:100%; }
    #sceneHolder { flex:1; height:100%; display:flex; }
    #glowscript { flex:1; }
    #graphHolder { flex:1; display:flex; flex-direction:column; height:100%; }
    .graphBox { flex:1; border-top:1px solid #333; }
    #graphHolder canvas { width:100% !important; height:100% !important; }
  </style>
</head>
<body>
  <div id="leftPane">
    <h2 class="text-lg font-bold">Projectile Motion</h2>

    <div class="control-group">
      <label for="velSlider">Horizontal Velocity (m/s)</label>
      <div class="control-inputs">
        <input type="range" id="velSlider" min="0" max="100" step="1" value="30">
        <input type="number" id="velInput" value="30" min="0" max="100" step="1">
      </div>
    </div>

    <div class="control-group">
      <label for="heightSlider">Initial Height (m)</label>
      <div class="control-inputs">
        <input type="range" id="heightSlider" min="0" max="500" step="10" value="100">
        <input type="number" id="heightInput" value="100" min="0" max="500" step="10">
      </div>
    </div>

    <div class="button-group">
      <button id="btnPlay">Play</button>
      <button id="btnPause">Pause</button>
      <button id="btnReset">Reset</button>
    </div>

    <div class="counters-container">
      <div class="counter"><span>Horizontal Velocity:</span><span id="counterVx">0</span></div>
      <div class="counter"><span>Vertical Velocity:</span><span id="counterVy">0</span></div>
      <div class="counter"><span>Current Height:</span><span id="counterY">0</span></div>
      <div class="counter"><span>Horizontal Distance:</span><span id="counterX">0</span></div>
    </div>
  </div>

  <div id="rightPane">
    <div id="sceneHolder"><div id="glowscript"></div></div>
    <div id="graphHolder">
      <div class="graphBox"><canvas id="velocityChart"></canvas></div>
      <div class="graphBox"><canvas id="positionChart"></canvas></div>
    </div>
  </div>

<script>
const g=10,DT=0.02;
let v0x=30,x=0,v0y=0,y=100,initH=100,t=0;
let scene,ball,animTimer=null;
let velocityChart,positionChart;
let vxArrow,vyArrow,vArrow;
const maxHeight=500,maxWidth=1000;

function drawTracks(){
  const origin=vec(0,0,0);
  curve({pos:[origin,vec(0,maxHeight,0)],color:color.white,radius:0.05});
  for(let i=0;i<=maxHeight;i+=10){
    const tick=(i%50===0)?2:1;
    curve({pos:[vec(-tick,i,0),vec(0,i,0)],color:color.white});
    if(i%50===0)label({pos:vec(-10,i,0),text:`${i}`,box:false,height:12,color:color.white});
  }
  curve({pos:[origin,vec(maxWidth,0,0)],color:color.white,radius:0.05});
  for(let j=0;j<=maxWidth;j+=10){
    const tick=(j%50===0)?2:1;
    curve({pos:[vec(j,0,0),vec(j,-tick,0)],color:color.white});
    if(j%100===0)label({pos:vec(j,-15,0),text:`${j}`,box:false,height:12,color:color.white});
  }
}

function initScene(){
  const sceneContainer=document.getElementById("glowscript");
  window.__context={glowscript_container:sceneContainer};
  scene=canvas({width:sceneContainer.clientWidth,height:sceneContainer.clientHeight,background:color.black});
  scene.autoscale=false;scene.userzoom=false;scene.userspin=false;
  scene.center=vec(maxWidth/2,maxHeight/2,0);
  scene.range=Math.max(maxWidth/2,maxHeight/2)*1.2;

  drawTracks();
  ball=sphere({pos:vec(0,initH,0),radius:8,color:color.orange,make_trail:true});
  vxArrow=arrow({pos:ball.pos,axis:vec(v0x*2,0,0),color:color.red,shaftwidth:5});
  vyArrow=arrow({pos:ball.pos,axis:vec(0,v0y*2,0),color:color.green,shaftwidth:5});
  vArrow=arrow({pos:ball.pos,axis:vec(v0x*2,v0y*2,0),color:color.cyan,shaftwidth:5});
}

function initCharts(){
  velocityChart=new Chart(document.getElementById('velocityChart'),{
    type:'line',
    data:{datasets:[
      {label:'Horizontal Velocity',data:[],borderColor:'red',borderWidth:2,pointRadius:0},
      {label:'Vertical Velocity',data:[],borderColor:'green',borderWidth:2,pointRadius:0}
    ]},
    options:{responsive:true,maintainAspectRatio:false,animation:false,
      scales:{x:{type:'linear',title:{display:true,text:'Time (s)',color:'#f3f4f6'},ticks:{color:'#f3f4f6'},min:0,max:12},
             y:{title:{display:true,text:'Velocity (m/s)',color:'#f3f4f6'},ticks:{color:'#f3f4f6'},min:-100,max:100}},
      plugins:{legend:{labels:{color:'#f3f4f6'}}}}
  });

  positionChart=new Chart(document.getElementById('positionChart'),{
    type:'line',
    data:{datasets:[
      {label:'Horizontal Distance',data:[],borderColor:'orange',borderWidth:2,pointRadius:0},
      {label:'Vertical Height',data:[],borderColor:'blue',borderWidth:2,pointRadius:0}
    ]},
    options:{responsive:true,maintainAspectRatio:false,animation:false,
      scales:{x:{type:'linear',title:{display:true,text:'Time (s)',color:'#f3f4f6'},ticks:{color:'#f3f4f6'},min:0,max:12},
             y:{title:{display:true,text:'Distance/Height (m)',color:'#f3f4f6'},ticks:{color:'#f3f4f6'},min:0,max:1000}},
      plugins:{legend:{labels:{color:'#f3f4f6'}}}}
  });
}

function updateCounters(){
  document.getElementById('counterVx').textContent = v0x.toFixed(2);
  document.getElementById('counterVy').textContent = v0y.toFixed(2);
  document.getElementById('counterY').textContent = Math.max(0, y).toFixed(2);
  document.getElementById('counterX').textContent = x.toFixed(2);
}

function tick(){
  if(y<=0){
    y = 0;
    updateCounters();
    pause();
    return;
  }
  t+=DT;x+=v0x*DT;v0y-=g*DT;y+=v0y*DT;
  ball.pos=vec(x,y,0);
  vxArrow.pos=ball.pos;vyArrow.pos=ball.pos;vArrow.pos=ball.pos;
  vxArrow.axis=vec(v0x*2,0,0);vyArrow.axis=vec(0,v0y*2,0);vArrow.axis=vec(v0x*2,v0y*2,0);

  velocityChart.data.datasets[0].data.push({x:t,y:v0x});
  velocityChart.data.datasets[1].data.push({x:t,y:v0y});
  positionChart.data.datasets[0].data.push({x:t,y:x});
  positionChart.data.datasets[1].data.push({x:t,y:y});

  updateCounters();

  velocityChart.update('none');
  positionChart.update('none');
}

function start(){if(!animTimer)animTimer=setInterval(tick,20);}
function pause(){clearInterval(animTimer);animTimer=null;}
function reset(){
  pause();t=0;x=0;v0y=0;y=initH;
  if(ball){ball.pos=vec(0,initH,0);ball.clear_trail();}
  if(vxArrow){vxArrow.pos=ball.pos;vyArrow.pos=ball.pos;vArrow.pos=ball.pos;}
  if(vxArrow){vxArrow.axis=vec(v0x*2,0,0);vyArrow.axis=vec(0,v0y*2,0);vArrow.axis=vec(v0x*2,v0y*2,0);}

  if(velocityChart){velocityChart.destroy();}
  if(positionChart){positionChart.destroy();}
  initCharts();
  updateCounters();
}

document.getElementById('velSlider').oninput=e=>{v0x=parseFloat(e.target.value);document.getElementById('velInput').value=v0x;};
document.getElementById('velInput').oninput=e=>{v0x=parseFloat(e.target.value);document.getElementById('velSlider').value=v0x;};
document.getElementById('heightSlider').oninput=e=>{initH=parseFloat(e.target.value);document.getElementById('heightInput').value=initH;y=initH;if(ball)ball.pos.y=initH;};
document.getElementById('heightInput').oninput=e=>{initH=parseFloat(e.target.value);document.getElementById('heightSlider').value=initH;y=initH;if(ball)ball.pos.y=initH;};

document.getElementById('btnPlay').onclick=start;
document.getElementById('btnPause').onclick=pause;
document.getElementById('btnReset').onclick=reset;

$(function(){initScene();initCharts();updateCounters();});
</script>
</body>
</html>
