<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GlowScript Vector Visualizer</title>
  <link type="text/css" href="https://www.glowscript.org/css/redmond/2.1/jquery-ui.custom.css" rel="stylesheet" />
  <link type="text/css" href="https://www.glowscript.org/css/ide.css" rel="stylesheet" />
  <script src="https://www.glowscript.org/lib/jquery/2.1/jquery.min.js"></script>
  <script src="https://www.glowscript.org/lib/jquery/2.1/jquery-ui.custom.min.js"></script>
  <script src="https://www.glowscript.org/package/glow.3.2.min.js"></script>
  <script src="https://www.glowscript.org/package/RSrun.3.2.min.js"></script>
</head>
<body>
  <div id="glowscript" class="glowscript"></div>

  <form id="vectorForm" style="margin: 10px;">
    <div>
      <label for="xValue">X Value:</label>
      <input type="number" id="xValue" value="3" step="0.1">
      <label for="yValue">Y Value:</label>
      <input type="number" id="yValue" value="4" step="0.1">
    </div>
    <div>
      <input type="checkbox" id="xComponentCheckbox">
      <label for="xComponentCheckbox">Show X-Component</label>
      <input type="checkbox" id="yComponentCheckbox">
      <label for="yComponentCheckbox">Show Y-Component</label>
      <input type="checkbox" id="vectorExprCheckbox">
      <label for="vectorExprCheckbox">Show Vector Expression</label>
    </div>
    <button type="button" id="drawButton">Draw Vector</button>
    <button type="button" id="magnitudeButton">Show Magnitude</button>
    <button type="button" id="resetButton">Reset</button>
  </form>

  <script type="text/javascript">
    window.__context = {
      glowscript_container: $("#glowscript").removeAttr("id")
    };

    $(document).ready(function () {
      let scene, vector, xComponent, yComponent;
      let xLabel, yLabel, magnitudeLabel, exprLabel;

      function init() {
        scene = canvas();
        scene.width = 800;
        scene.height = 600;
        scene.camera.pos = vec(0, 0, 20);
        setupEventListeners();
      }

      function setupEventListeners() {
        $('#drawButton').on('click', drawVector);
        $('#resetButton').on('click', resetAll);
        $('#magnitudeButton').on('click', showMagnitude);
        $('#xComponentCheckbox, #yComponentCheckbox').on('change', toggleComponents);
        $('#vectorExprCheckbox').on('change', toggleVectorExpr);
      }

      function drawVector() {
        clearScene();
        const x = Number($('#xValue').val());
        const y = Number($('#yValue').val());

        arrow({ pos: vec(0, 0, 0), axis: vec(Math.sign(x) * Math.abs(x) * 1.5, 0, 0), color: color.blue, shaftwidth: 0.1 });
        arrow({ pos: vec(0, 0, 0), axis: vec(0, Math.sign(y) * Math.abs(y) * 1.5, 0), color: color.green, shaftwidth: 0.1 });

        vector = arrow({ pos: vec(0, 0, 0), axis: vec(x, y, 0), color: color.yellow, shaftwidth: 0.2 });

        label({ pos: vec(x, y, 0), text: `A(${x}, ${y})`, color: color.white, height: 12 });

        toggleComponents();
        toggleVectorExpr();
      }

      function toggleComponents() {
        const x = Number($('#xValue').val());
        const y = Number($('#yValue').val());

        if (xComponent) xComponent.visible = false;
        if (yComponent) yComponent.visible = false;
        if (xLabel) xLabel.visible = false;
        if (yLabel) yLabel.visible = false;

        if ($('#xComponentCheckbox').is(':checked')) {
          xComponent = cylinder({ pos: vec(0, y, 0), axis: vec(x, 0, 0), color: color.cyan, radius: 0.05, opacity: 0.8 });
          xLabel = label({ pos: vec(x / 2, y, 0), text: `x = ${x}`, color: color.cyan, height: 10 });
        }

        if ($('#yComponentCheckbox').is(':checked')) {
          yComponent = cylinder({ pos: vec(x, 0, 0), axis: vec(0, y, 0), color: color.cyan, radius: 0.05, opacity: 0.8 });
          yLabel = label({ pos: vec(x, y / 2, 0), text: `y = ${y}`, color: color.cyan, height: 10 });
        }
      }

      function toggleVectorExpr() {
        const x = Number($('#xValue').val());
        const y = Number($('#yValue').val());

        if (exprLabel) exprLabel.visible = false;

        if ($('#vectorExprCheckbox').is(':checked')) {
          exprLabel = label({ pos: vec(x + 0.5, y + 0.5, 0), text: `${x}i + ${y}j`, color: color.white, height: 10, box: false, opacity: 0 });
        }
      }

      function showMagnitude() {
        if (!vector) return;
        const x = Number($('#xValue').val());
        const y = Number($('#yValue').val());
        const magnitude = Math.sqrt(x * x + y * y).toFixed(2);

        if (magnitudeLabel) magnitudeLabel.visible = false;

        magnitudeLabel = label({ pos: vec(x / 2, y / 2, 0), text: `|A| = ${magnitude}`, color: color.orange, height: 12 });
      }

      function clearScene() {
        for (let obj of scene.objects) obj.visible = false;
        scene.objects.length = 0;
        if (magnitudeLabel) magnitudeLabel.visible = false;
        if (exprLabel) exprLabel.visible = false;
      }

      function resetAll() {
        clearScene();
        $('#xValue').val('');
        $('#yValue').val('');
        $('#xComponentCheckbox').prop('checked', false);
        $('#yComponentCheckbox').prop('checked', false);
        $('#vectorExprCheckbox').prop('checked', false);
      }

      init();
    });
  </script>
</body>
</html>
